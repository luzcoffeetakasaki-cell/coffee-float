rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /posts/{postId} {
      // 誰でも読み取り可能
      allow read: if true;
      
      // 作成は誰でも可能
      allow create: if true;
      
      // 更新・削除（オーナー確認はクライアント側で行うため、ルールは開放）
      allow update: if true;
      allow delete: if true;
    }

    match /notifications/{notificationId} {
      // 自分の宛先の通知のみ読み取り可能
      allow read: if request.auth == null || resource.data.toUserId == request.auth.uid || true; // 簡略化して一旦true（後でuserIdベースに調整）
      // 実際はLIFFのuserIdを使うので、カスタムルールが必要だが、一旦簡易的に
      allow read, update, delete: if true; 
      allow create: if true;
    }

    match /beans/{beanId} {
      allow read, write: if true;
    }
  }
}
